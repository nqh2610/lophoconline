ğŸš€ Starting Auto Test...

âœ… Server found at port 3000

ğŸ“‹ TEST 1: Initial Join Connection
============================================================

ğŸ‘¨â€ğŸ« Opening Tutor browser...

ğŸŒ [Tutor] Opening: http://localhost:3000/test-videolify?room=auto-test-1763128597062&name=Tutor&role=tutor
[Tutor] âœ¨ [Videolify] New tab detected - will generate new peer ID
[Tutor] âœ¨ [Videolify] Generated new peer ID: peer-1763128599546-ffru3xxuj
[Tutor] ğŸ’¾ [Videolify] Peer ID saved to session & local storage
[Tutor] [Videolify] ğŸš€ Init useEffect starting...
[Tutor] [Videolify] ğŸ” Checking WebRTC support...
[Tutor] [Videolify] âœ… WebRTC supported
[Tutor] [Videolify] ğŸ“¹ Requesting media access...
[Tutor] [Videolify] ğŸ§ª Test refs + file functions exposed to window
[Tutor] ğŸ”„ [Videolify] Skipping cleanup - React StrictMode double-render
[Tutor] [Videolify] ğŸš€ Init useEffect starting...
[Tutor] [Videolify] ğŸ” Checking WebRTC support...
[Tutor] [Videolify] âœ… WebRTC supported
[Tutor] [Videolify] ğŸ“¹ Requesting media access...
[Tutor] [Videolify] ğŸ§ª Test refs + file functions exposed to window
[Tutor] [Videolify] âœ… Local media initialized
[Tutor] [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
[Tutor] ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128599546-ffru3xxuj
[Tutor] [Videolify] âœ… Local media initialized
[Tutor] [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
[Tutor] [Videolify] Closing existing SSE connection before creating new one
[Tutor] ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128599546-ffru3xxuj
[Tutor] âœ… [Videolify] SSE connection opened
[Tutor] [Videolify] SSE ready, calling onReady callback
[Tutor] [Videolify] âœ… SSE ready, now checking if we should join...
[Tutor] [Videolify] ğŸšª Joining room...
[Tutor] [Videolify] Joining room: auto-test-1763128597062 as peer: peer-1763128599546-ffru3xxuj
[Tutor] [Videolify] âœ… Joined room successfully: JSHandle@object
[Tutor] [Videolify] ğŸ“Š Received 0 existing peers: JSHandle@array
[Tutor] [Videolify] ğŸ¯ Server says shouldInitiate: undefined
[Tutor] [Videolify] No existing peers, waiting for someone to join
[Tutor] [Videolify] âœ… Join room completed
âœ… Tutor joined room

ğŸ‘¨â€ğŸ“ Opening Student browser...

ğŸŒ [Student] Opening: http://localhost:3000/test-videolify?room=auto-test-1763128597062&name=Student&role=student
[Student] âœ¨ [Videolify] New tab detected - will generate new peer ID
[Student] âœ¨ [Videolify] Generated new peer ID: peer-1763128607421-p1g9737dt
[Student] ğŸ’¾ [Videolify] Peer ID saved to session & local storage
[Student] [Videolify] ğŸš€ Init useEffect starting...
[Student] [Videolify] ğŸ” Checking WebRTC support...
[Student] [Videolify] âœ… WebRTC supported
[Student] [Videolify] ğŸ“¹ Requesting media access...
[Student] [Videolify] ğŸ§ª Test refs + file functions exposed to window
[Student] ğŸ”„ [Videolify] Skipping cleanup - React StrictMode double-render
[Student] [Videolify] ğŸš€ Init useEffect starting...
[Student] [Videolify] ğŸ” Checking WebRTC support...
[Student] [Videolify] âœ… WebRTC supported
[Student] [Videolify] ğŸ“¹ Requesting media access...
[Student] [Videolify] ğŸ§ª Test refs + file functions exposed to window
[Student] [Videolify] âœ… Local media initialized
[Student] [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
[Student] ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128607421-p1g9737dt
[Student] [Videolify] âœ… Local media initialized
[Student] [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
[Student] [Videolify] Closing existing SSE connection before creating new one
[Student] ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128607421-p1g9737dt
[Student] âœ… [Videolify] SSE connection opened
[Student] [Videolify] SSE ready, calling onReady callback
[Student] [Videolify] âœ… SSE ready, now checking if we should join...
[Student] [Videolify] ğŸšª Joining room...
[Student] [Videolify] Joining room: auto-test-1763128597062 as peer: peer-1763128607421-p1g9737dt
[Student] [Videolify] âœ… Joined room successfully: JSHandle@object
[Student] [Videolify] ğŸ“Š Received 0 existing peers: JSHandle@array
[Student] [Videolify] ğŸ¯ Server says shouldInitiate: undefined
[Student] [Videolify] No existing peers, waiting for someone to join
[Student] [Videolify] âœ… Join room completed
âœ… Student joined room

ğŸ” Checking if Tutor received peer-joined event...
âŒ Tutor did NOT receive peer-joined event!

ğŸ“Š Tutor logs related to connection:
  âœ¨ [Videolify] New tab detected - will generate new peer ID
  âœ¨ [Videolify] Generated new peer ID: peer-1763128599546-ffru3xxuj
  [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
  ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128599546-ffru3xxuj
  [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
  [Videolify] Closing existing SSE connection before creating new one
  ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128599546-ffru3xxuj
  âœ… [Videolify] SSE connection opened
  [Videolify] SSE ready, calling onReady callback
  [Videolify] âœ… SSE ready, now checking if we should join...
  [Videolify] Joining room: auto-test-1763128597062 as peer: peer-1763128599546-ffru3xxuj
  [Videolify] âœ… Joined room successfully: JSHandle@object
  [Videolify] ğŸ“Š Received 0 existing peers: JSHandle@array
  [Videolify] No existing peers, waiting for someone to join

ğŸ“Š Student logs related to connection:
  âœ¨ [Videolify] New tab detected - will generate new peer ID
  âœ¨ [Videolify] Generated new peer ID: peer-1763128607421-p1g9737dt
  [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
  ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128607421-p1g9737dt
  [Videolify] ğŸ“¡ Connecting SSE and waiting for ready...
  [Videolify] Closing existing SSE connection before creating new one
  ğŸ’¾ [Videolify] Session state saved with peerId: peer-1763128607421-p1g9737dt
  âœ… [Videolify] SSE connection opened
  [Videolify] SSE ready, calling onReady callback
  [Videolify] âœ… SSE ready, now checking if we should join...
  [Videolify] Joining room: auto-test-1763128597062 as peer: peer-1763128607421-p1g9737dt
  [Videolify] âœ… Joined room successfully: JSHandle@object
  [Videolify] ğŸ“Š Received 0 existing peers: JSHandle@array
  [Videolify] No existing peers, waiting for someone to join

âŒ TEST FAILED: Peer-joined event not received

ğŸ“Š Error Details: Error: Peer-joined event not received
    at test (file:///e:/LopHocTrucTuyen/test-connection-auto.mjs:119:13)
