import * as dotenv from 'dotenv';

// Load environment variables FIRST
dotenv.config();

if (!process.env.DATABASE_URL) {
  console.error('ERROR: DATABASE_URL not found');
  process.exit(1);
}

console.log('‚úì Environment variables loaded');

import { db } from './src/lib/db';
import { users, tutors, subjects, gradeLevels, tutorSubjects, timeSlots } from './src/lib/schema';
import bcrypt from 'bcryptjs';

async function seedOptimizedDatabase() {
  console.log('üå± Starting optimized database seeding...\n');

  try {
    // ==================== 1. SEED SUBJECTS ====================
    console.log('üìö Seeding subjects...');
    const subjectsData = [
      { name: 'To√°n', description: 'To√°n h·ªçc c√°c c·∫•p' },
      { name: 'Ti·∫øng Anh', description: 'Ti·∫øng Anh giao ti·∫øp v√† h·ªçc thu·∫≠t' },
      { name: 'V·∫≠t L√Ω', description: 'V·∫≠t l√Ω ph·ªï th√¥ng' },
      { name: 'H√≥a h·ªçc', description: 'H√≥a h·ªçc ph·ªï th√¥ng' },
      { name: 'Sinh h·ªçc', description: 'Sinh h·ªçc ph·ªï th√¥ng' },
      { name: 'Ng·ªØ VƒÉn', description: 'Ng·ªØ vƒÉn Vi·ªát Nam' },
      { name: 'L·ªãch S·ª≠', description: 'L·ªãch s·ª≠ Vi·ªát Nam v√† th·∫ø gi·ªõi' },
      { name: 'ƒê·ªãa L√Ω', description: 'ƒê·ªãa l√Ω t·ª± nhi√™n v√† kinh t·∫ø' },
      { name: 'Tin h·ªçc', description: 'Tin h·ªçc v√† l·∫≠p tr√¨nh' },
      { name: 'IELTS', description: 'Luy·ªán thi IELTS' },
      { name: 'TOEFL', description: 'Luy·ªán thi TOEFL' },
      { name: 'SAT', description: 'Luy·ªán thi SAT' },
    ];

    const insertedSubjects: any[] = [];
    for (const subject of subjectsData) {
      const result = await db.insert(subjects).values(subject);
      insertedSubjects.push({ id: Number(result[0].insertId), ...subject });
      console.log(`  ‚úì ${subject.name}`);
    }

    // ==================== 2. SEED GRADE LEVELS ====================
    console.log('\nüéì Seeding grade levels...');
    const gradeLevelsData = [
      // Ti·ªÉu h·ªçc: L·ªõp 1-5
      { name: 'L·ªõp 1', category: 'Ti·ªÉu h·ªçc', sortOrder: 1 },
      { name: 'L·ªõp 2', category: 'Ti·ªÉu h·ªçc', sortOrder: 2 },
      { name: 'L·ªõp 3', category: 'Ti·ªÉu h·ªçc', sortOrder: 3 },
      { name: 'L·ªõp 4', category: 'Ti·ªÉu h·ªçc', sortOrder: 4 },
      { name: 'L·ªõp 5', category: 'Ti·ªÉu h·ªçc', sortOrder: 5 },

      // THCS: L·ªõp 6-9
      { name: 'L·ªõp 6', category: 'THCS', sortOrder: 6 },
      { name: 'L·ªõp 7', category: 'THCS', sortOrder: 7 },
      { name: 'L·ªõp 8', category: 'THCS', sortOrder: 8 },
      { name: 'L·ªõp 9', category: 'THCS', sortOrder: 9 },

      // THPT: L·ªõp 10-12
      { name: 'L·ªõp 10', category: 'THPT', sortOrder: 10 },
      { name: 'L·ªõp 11', category: 'THPT', sortOrder: 11 },
      { name: 'L·ªõp 12', category: 'THPT', sortOrder: 12 },

      // Luy·ªán thi
      { name: 'Luy·ªán thi THPT Qu·ªëc gia', category: 'Luy·ªán thi', sortOrder: 13 },
      { name: 'Luy·ªán thi ƒê·∫°i h·ªçc', category: 'Luy·ªán thi', sortOrder: 14 },
      { name: 'Luy·ªán thi IELTS', category: 'Luy·ªán thi', sortOrder: 15 },
      { name: 'Luy·ªán thi TOEFL', category: 'Luy·ªán thi', sortOrder: 16 },
      { name: 'Luy·ªán thi SAT', category: 'Luy·ªán thi', sortOrder: 17 },

      // Kh√°c
      { name: 'Ng∆∞·ªùi ƒëi l√†m', category: 'Kh√°c', sortOrder: 18 },
      { name: 'ƒê·∫°i h·ªçc', category: 'Kh√°c', sortOrder: 19 },
      { name: 'Kh√°c', category: 'Kh√°c', sortOrder: 20 },
    ];

    const insertedGradeLevels: any[] = [];
    for (const gradeLevel of gradeLevelsData) {
      const result = await db.insert(gradeLevels).values(gradeLevel);
      insertedGradeLevels.push({ id: Number(result[0].insertId), ...gradeLevel });
      console.log(`  ‚úì ${gradeLevel.name}`);
    }

    // ==================== 3. SEED TUTORS ====================
    console.log('\nüë®‚Äçüè´ Seeding tutors...');

    const tutorsData = [
      {
        username: 'tutor_mai',
        email: 'mai@example.com',
        fullName: 'Nguy·ªÖn Th·ªã Mai',
        avatar: 'https://i.pravatar.cc/150?img=5',
        bio: 'T√¥i l√† gi√°o vi√™n To√°n c√≥ 5 nƒÉm kinh nghi·ªám gi·∫£ng d·∫°y THPT. T√¥i ƒëam m√™ gi√∫p h·ªçc sinh hi·ªÉu r√µ b·∫£n ch·∫•t c·ªßa to√°n h·ªçc v√† ph√°t tri·ªÉn t∆∞ duy logic. V·ªõi ph∆∞∆°ng ph√°p gi·∫£ng d·∫°y linh ho·∫°t v√† t·∫≠n t√¢m, t√¥i ƒë√£ gi√∫p nhi·ªÅu h·ªçc sinh c·∫£i thi·ªán ƒëi·ªÉm s·ªë v√† y√™u th√≠ch m√¥n To√°n h∆°n.',
        teachingMethod: 'T√¥i s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p gi·∫£ng d·∫°y t√≠ch c·ª±c, khuy·∫øn kh√≠ch h·ªçc sinh t·ª± suy nghƒ© v√† gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ. M·ªói b√†i h·ªçc ƒë·ªÅu c√≥ b√†i t·∫≠p th·ª±c h√†nh v√† ·ª©ng d·ª•ng th·ª±c t·∫ø ƒë·ªÉ h·ªçc sinh th·∫•y ƒë∆∞·ª£c t√≠nh h·ªØu √≠ch c·ªßa m√¥n To√°n.',
        education: JSON.stringify([{
          degree: 'C·ª≠ nh√¢n To√°n h·ªçc',
          school: 'ƒê·∫°i h·ªçc S∆∞ ph·∫°m H√† N·ªôi',
          year: '2018'
        }]),
        subjects: ['To√°n', 'V·∫≠t L√Ω'], // Will be converted to subject IDs
        gradeLevels: ['L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12'],
        experience: 5,
        hourlyRate: 200000,
        occupation: 'Gi√°o vi√™n',
        rating: 49,
        totalReviews: 128,
        totalStudents: 45,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['Ch·ª©ng ch·ªâ gi√°o vi√™n d·∫°y gi·ªèi c·∫•p th√†nh ph·ªë']),
        achievements: JSON.stringify(['Top 10 gi√°o vi√™n xu·∫•t s·∫Øc nƒÉm 2023']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '19:00', end: '21:00' }, // T2 t·ªëi
          { day: 3, shift: 'evening', start: '19:00', end: '21:00' }, // T4 t·ªëi
          { day: 5, shift: 'evening', start: '19:00', end: '21:00' }, // T6 t·ªëi
          { day: 6, shift: 'afternoon', start: '14:00', end: '20:00' }, // T7 chi·ªÅu-t·ªëi
          { day: 0, shift: 'afternoon', start: '14:00', end: '20:00' }, // CN chi·ªÅu-t·ªëi
        ]
      },
      {
        username: 'tutor_hung',
        email: 'hung@example.com',
        fullName: 'Tr·∫ßn VƒÉn H√πng',
        avatar: 'https://i.pravatar.cc/150?img=12',
        bio: 'Gi√°o vi√™n Ti·∫øng Anh chuy√™n luy·ªán thi IELTS, TOEFL v·ªõi 7 nƒÉm kinh nghi·ªám. ƒê√£ gi√∫p h∆°n 200 h·ªçc sinh ƒë·∫°t ƒëi·ªÉm m·ª•c ti√™u. T√¥i t·ª± tin c√≥ th·ªÉ gi√∫p b·∫°n ƒë·∫°t ƒë∆∞·ª£c ∆∞·ªõc m∆° du h·ªçc ho·∫∑c l√†m vi·ªác t·∫°i c√°c c√¥ng ty qu·ªëc t·∫ø.',
        teachingMethod: 'Ph∆∞∆°ng ph√°p h·ªçc t·∫≠p t√≠ch c·ª±c v·ªõi tr·ªçng t√¢m l√† giao ti·∫øp v√† th·ª±c h√†nh. S·ª≠ d·ª•ng t√†i li·ªáu c·∫≠p nh·∫≠t v√† m√¥ ph·ªèng thi th·ª±c t·∫ø. L·ªô tr√¨nh h·ªçc ƒë∆∞·ª£c c√° nh√¢n h√≥a theo t·ª´ng h·ªçc vi√™n.',
        education: JSON.stringify([{
          degree: 'Th·∫°c sƒ© Ng√¥n ng·ªØ Anh',
          school: 'ƒê·∫°i h·ªçc Ngo·∫°i ng·ªØ - ƒêHQGHN',
          year: '2016'
        }]),
        subjects: ['Ti·∫øng Anh', 'IELTS', 'TOEFL'],
        gradeLevels: ['L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi IELTS', 'Luy·ªán thi TOEFL', 'Ng∆∞·ªùi ƒëi l√†m'],
        experience: 7,
        hourlyRate: 250000,
        occupation: 'Chuy√™n gia',
        rating: 50,
        totalReviews: 95,
        totalStudents: 67,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['IELTS 8.5', 'TOEFL 115', 'TESOL Certificate']),
        achievements: JSON.stringify(['Gi·∫£ng vi√™n xu·∫•t s·∫Øc nƒÉm 2022', 'Top 5 gi√°o vi√™n IELTS t·ªët nh·∫•t']),
        timeSlots: [
          { day: 2, shift: 'evening', start: '18:00', end: '21:00' }, // T3 t·ªëi
          { day: 4, shift: 'evening', start: '18:00', end: '21:00' }, // T5 t·ªëi
          { day: 6, shift: 'evening', start: '18:00', end: '21:00' }, // T7 t·ªëi
          { day: 0, shift: 'morning', start: '09:00', end: '12:00' }, // CN s√°ng
          { day: 0, shift: 'afternoon', start: '14:00', end: '18:00' }, // CN chi·ªÅu
        ]
      },
      {
        username: 'tutor_tu',
        email: 'tu@example.com',
        fullName: 'L√™ Minh T√∫',
        avatar: 'https://i.pravatar.cc/150?img=33',
        bio: 'Sinh vi√™n nƒÉm cu·ªëi ng√†nh C√¥ng ngh·ªá th√¥ng tin, ƒëam m√™ gi·∫£ng d·∫°y To√°n v√† Tin h·ªçc cho h·ªçc sinh THCS. V·ªõi ki·∫øn th·ª©c v·ªØng v√†ng v√† c√°ch ti·∫øp c·∫≠n tr·∫ª trung, t√¥i gi√∫p c√°c em h·ªçc m·ªôt c√°ch th√∫ v·ªã v√† hi·ªáu qu·∫£.',
        teachingMethod: 'S·ª≠ d·ª•ng c√°c v√≠ d·ª• th·ª±c t·∫ø, game h√≥a v√† c√¥ng ngh·ªá ƒë·ªÉ l√†m cho vi·ªác h·ªçc tr·ªü n√™n th√∫ v·ªã v√† d·ªÖ hi·ªÉu. K·∫øt h·ª£p l√Ω thuy·∫øt v·ªõi th·ª±c h√†nh ngay trong bu·ªïi h·ªçc.',
        education: JSON.stringify([{
          degree: 'Sinh vi√™n nƒÉm 4 C√¥ng ngh·ªá th√¥ng tin',
          school: 'ƒê·∫°i h·ªçc B√°ch khoa H√† N·ªôi',
          year: '2025'
        }]),
        subjects: ['To√°n', 'V·∫≠t L√Ω', 'Tin h·ªçc'],
        gradeLevels: ['L·ªõp 3', 'L·ªõp 4', 'L·ªõp 5', 'L·ªõp 6', 'L·ªõp 7', 'L·ªõp 8', 'L·ªõp 9'],
        experience: 3,
        hourlyRate: 120000,
        occupation: 'Sinh vi√™n',
        rating: 47,
        totalReviews: 76,
        totalStudents: 34,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['Gi·∫£i Nh·∫•t Olympic Tin h·ªçc sinh vi√™n 2023']),
        achievements: JSON.stringify(['GPA 3.8/4.0']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '17:00', end: '20:00' }, // T2 t·ªëi
          { day: 2, shift: 'evening', start: '17:00', end: '20:00' }, // T3 t·ªëi
          { day: 3, shift: 'evening', start: '17:00', end: '20:00' }, // T4 t·ªëi
          { day: 4, shift: 'evening', start: '17:00', end: '20:00' }, // T5 t·ªëi
          { day: 5, shift: 'evening', start: '17:00', end: '20:00' }, // T6 t·ªëi
          { day: 6, shift: 'afternoon', start: '14:00', end: '18:00' }, // T7 chi·ªÅu
        ]
      },
      {
        username: 'tutor_ha',
        email: 'ha@example.com',
        fullName: 'Ph·∫°m Thu H√†',
        avatar: 'https://i.pravatar.cc/150?img=47',
        bio: 'Gi√°o vi√™n H√≥a h·ªçc v√† Sinh h·ªçc v·ªõi 4 nƒÉm kinh nghi·ªám, chuy√™n luy·ªán thi ƒë·∫°i h·ªçc kh·ªëi B. ƒê√£ gi√∫p 90% h·ªçc sinh ƒë·∫°t ƒëi·ªÉm cao v√† ƒë·ªó ƒë·∫°i h·ªçc. T√¥i cam k·∫øt mang l·∫°i k·∫øt qu·∫£ t·ªët nh·∫•t cho h·ªçc sinh.',
        teachingMethod: 'K·∫øt h·ª£p l√Ω thuy·∫øt v·ªõi th·ª±c h√†nh th√≠ nghi·ªám (khi c√≥ th·ªÉ). T·∫≠p trung v√†o hi·ªÉu b·∫£n ch·∫•t v√† ·ª©ng d·ª•ng th·ª±c t·∫ø. C√≥ h·ªá th·ªëng b√†i t·∫≠p t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao.',
        education: JSON.stringify([{
          degree: 'C·ª≠ nh√¢n H√≥a h·ªçc',
          school: 'ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n - ƒêHQGHN',
          year: '2019'
        }]),
        subjects: ['H√≥a h·ªçc', 'Sinh h·ªçc'],
        gradeLevels: ['L·ªõp 8', 'L·ªõp 9', 'L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi ƒê·∫°i h·ªçc'],
        experience: 4,
        hourlyRate: 180000,
        occupation: 'Gi√°o vi√™n',
        rating: 48,
        totalReviews: 54,
        totalStudents: 28,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['Ch·ª©ng ch·ªâ gi·∫£ng d·∫°y THPT']),
        achievements: JSON.stringify(['90% h·ªçc sinh ƒë·ªó ƒë·∫°i h·ªçc kh·ªëi B']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '18:00', end: '21:00' }, // T2 t·ªëi
          { day: 3, shift: 'evening', start: '18:00', end: '21:00' }, // T4 t·ªëi
          { day: 5, shift: 'evening', start: '18:00', end: '21:00' }, // T6 t·ªëi
          { day: 6, shift: 'afternoon', start: '15:00', end: '19:00' }, // T7 chi·ªÅu
        ]
      },
      {
        username: 'tutor_thanh',
        email: 'thanh@example.com',
        fullName: 'ƒê·ªó VƒÉn Th√†nh',
        avatar: 'https://i.pravatar.cc/150?img=15',
        bio: 'Gi√°o vi√™n L·ªãch S·ª≠ v√† ƒê·ªãa L√Ω v·ªõi ƒëam m√™ truy·ªÅn ƒë·∫°t ki·∫øn th·ª©c x√£ h·ªôi. C√≥ 4 nƒÉm kinh nghi·ªám gi·∫£ng d·∫°y THPT, t√¥i s·ª≠ d·ª•ng c√°c c√¢u chuy·ªán l·ªãch s·ª≠ th√∫ v·ªã v√† b·∫£n ƒë·ªì t∆∞∆°ng t√°c ƒë·ªÉ gi√∫p h·ªçc sinh hi·ªÉu s√¢u h∆°n.',
        teachingMethod: 'K·∫øt h·ª£p gi·∫£ng d·∫°y l√Ω thuy·∫øt v·ªõi c√°c case study, video t√†i li·ªáu v√† th·∫£o lu·∫≠n nh√≥m. H·ªçc sinh s·∫Ω h·ªçc c√°ch ph√¢n t√≠ch s·ª± ki·ªán l·ªãch s·ª≠ v√† hi·ªÉu ƒë∆∞·ª£c c√°c y·∫øu t·ªë ƒë·ªãa l√Ω ·∫£nh h∆∞·ªüng ƒë·∫øn cu·ªôc s·ªëng.',
        education: JSON.stringify([{
          degree: 'C·ª≠ nh√¢n S·ª≠ h·ªçc',
          school: 'ƒê·∫°i h·ªçc S∆∞ ph·∫°m H√† N·ªôi',
          year: '2019'
        }]),
        subjects: ['L·ªãch S·ª≠', 'ƒê·ªãa L√Ω'],
        gradeLevels: ['L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12'],
        experience: 4,
        hourlyRate: 150000,
        occupation: 'Gi√°o vi√™n',
        rating: 46,
        totalReviews: 42,
        totalStudents: 31,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['Ch·ª©ng ch·ªâ gi·∫£ng d·∫°y THPT']),
        achievements: JSON.stringify([]),
        timeSlots: [
          { day: 2, shift: 'evening', start: '18:00', end: '21:00' }, // T3 t·ªëi
          { day: 4, shift: 'evening', start: '18:00', end: '21:00' }, // T5 t·ªëi
          { day: 0, shift: 'morning', start: '09:00', end: '12:00' }, // CN s√°ng
          { day: 0, shift: 'afternoon', start: '14:00', end: '17:00' }, // CN chi·ªÅu
        ]
      },
      {
        username: 'tutor_lan',
        email: 'lan@example.com',
        fullName: 'Ho√†ng Th·ªã Lan',
        avatar: 'https://i.pravatar.cc/150?img=23',
        bio: 'Gi√°o vi√™n Ng·ªØ VƒÉn chuy√™n luy·ªán thi THPT Qu·ªëc gia v√† ƒê·∫°i h·ªçc. 6 nƒÉm kinh nghi·ªám v·ªõi nhi·ªÅu h·ªçc sinh ƒë·∫°t ƒëi·ªÉm cao. T√¥i y√™u th√≠ch vƒÉn h·ªçc Vi·ªát Nam v√† lu√¥n truy·ªÅn c·∫£m h·ª©ng cho h·ªçc sinh y√™u m√¥n VƒÉn.',
        teachingMethod: 'Ph√¢n t√≠ch t√°c ph·∫©m vƒÉn h·ªçc m·ªôt c√°ch s√¢u s·∫Øc v√† d·ªÖ hi·ªÉu. H∆∞·ªõng d·∫´n k·ªπ nƒÉng l√†m b√†i thi, vi·∫øt vƒÉn ngh·ªã lu·∫≠n v√† vƒÉn t·ª± s·ª±. C√≥ b·ªô t√†i li·ªáu t·ªïng h·ª£p ƒë·∫ßy ƒë·ªß v√† b√†i t·∫≠p luy·ªán thi.',
        education: JSON.stringify([{
          degree: 'C·ª≠ nh√¢n Ng·ªØ vƒÉn',
          school: 'ƒê·∫°i h·ªçc S∆∞ ph·∫°m H√† N·ªôi',
          year: '2017'
        }]),
        subjects: ['Ng·ªØ VƒÉn'],
        gradeLevels: ['L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi THPT Qu·ªëc gia', 'Luy·ªán thi ƒê·∫°i h·ªçc'],
        experience: 6,
        hourlyRate: 190000,
        occupation: 'Gi√°o vi√™n',
        rating: 49,
        totalReviews: 88,
        totalStudents: 52,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['Ch·ª©ng ch·ªâ gi·∫£ng d·∫°y THPT']),
        achievements: JSON.stringify(['Gi√°o vi√™n gi·ªèi c·∫•p qu·∫≠n 2022']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '19:00', end: '21:00' }, // T2 t·ªëi
          { day: 3, shift: 'evening', start: '19:00', end: '21:00' }, // T4 t·ªëi
          { day: 5, shift: 'evening', start: '19:00', end: '21:00' }, // T6 t·ªëi
          { day: 6, shift: 'afternoon', start: '14:00', end: '17:00' }, // T7 chi·ªÅu
          { day: 6, shift: 'evening', start: '17:00', end: '19:00' }, // T7 t·ªëi
        ]
      },
      {
        username: 'tutor_duc',
        email: 'duc@example.com',
        fullName: 'B√πi Minh ƒê·ª©c',
        avatar: 'https://i.pravatar.cc/150?img=60',
        bio: 'Chuy√™n gia luy·ªán thi SAT v√† TOEFL v·ªõi 5 nƒÉm kinh nghi·ªám. T·ª´ng du h·ªçc t·∫°i M·ªπ v√† hi·ªÉu r√µ y√™u c·∫ßu c·ªßa c√°c k·ª≥ thi qu·ªëc t·∫ø. ƒê√£ gi√∫p 100+ h·ªçc sinh ƒë·∫°t ƒëi·ªÉm cao v√† nh·∫≠n h·ªçc b·ªïng du h·ªçc.',
        teachingMethod: 'L·ªô tr√¨nh h·ªçc ƒë∆∞·ª£c c√° nh√¢n h√≥a d·ª±a tr√™n ƒëi·ªÉm xu·∫•t ph√°t v√† m·ª•c ti√™u c·ªßa h·ªçc vi√™n. S·ª≠ d·ª•ng t√†i li·ªáu chu·∫©n qu·ªëc t·∫ø v√† m√¥ ph·ªèng thi th·ª±c chi·∫øn. Coaching 1-1 t·∫≠n t√¢m v√† theo s√°t ti·∫øn ƒë·ªô.',
        education: JSON.stringify([{
          degree: 'Th·∫°c sƒ© Qu·∫£n tr·ªã Kinh doanh',
          school: 'University of California, Berkeley',
          year: '2018'
        }]),
        subjects: ['Ti·∫øng Anh', 'SAT', 'TOEFL'],
        gradeLevels: ['L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi SAT', 'Luy·ªán thi TOEFL', 'ƒê·∫°i h·ªçc'],
        experience: 5,
        hourlyRate: 300000,
        occupation: 'Chuy√™n gia',
        rating: 50,
        totalReviews: 35,
        totalStudents: 28,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['SAT 1550/1600', 'TOEFL 118/120', 'MBA Berkeley']),
        achievements: JSON.stringify(['Top 3 SAT tutors VN 2023', '98% h·ªçc sinh ƒë·∫°t m·ª•c ti√™u']),
        timeSlots: [
          { day: 6, shift: 'morning', start: '09:00', end: '12:00' }, // T7 s√°ng
          { day: 6, shift: 'afternoon', start: '14:00', end: '18:00' }, // T7 chi·ªÅu
          { day: 0, shift: 'morning', start: '09:00', end: '12:00' }, // CN s√°ng
          { day: 0, shift: 'afternoon', start: '14:00', end: '18:00' }, // CN chi·ªÅu
        ]
      },
      {
        username: 'tutor_huong',
        email: 'huong@example.com',
        fullName: 'Ng√¥ Th·ªã H∆∞∆°ng',
        avatar: 'https://i.pravatar.cc/150?img=27',
        bio: 'Gi√°o vi√™n Ti·∫øng Anh v·ªõi chuy√™n m√¥n IELTS, c√≥ 5 nƒÉm kinh nghi·ªám gi·∫£ng d·∫°y t·ª´ thi·ªÉu ni√™n ƒë·∫øn ng∆∞·ªùi ƒëi l√†m. IELTS 8.0, ƒëam m√™ gi√∫p h·ªçc vi√™n t·ª± tin giao ti·∫øp v√† ƒë·∫°t band ƒëi·ªÉm m·ª•c ti√™u.',
        teachingMethod: 'T·∫≠p trung ph√°t tri·ªÉn 4 k·ªπ nƒÉng m·ªôt c√°ch c√¢n b·∫±ng. Luy·ªán ph√°t √¢m chu·∫©n, m·ªü r·ªông v·ªën t·ª´ v·ª±ng v√† c·∫•u tr√∫c ng·ªØ ph√°p trong ng·ªØ c·∫£nh th·ª±c t·∫ø. C√≥ chi·∫øn l∆∞·ª£c l√†m b√†i thi hi·ªáu qu·∫£.',
        education: JSON.stringify([{
          degree: 'C·ª≠ nh√¢n Ng√¥n ng·ªØ Anh',
          school: 'ƒê·∫°i h·ªçc Ngo·∫°i ng·ªØ - ƒêHQGHN',
          year: '2018'
        }]),
        subjects: ['Ti·∫øng Anh', 'IELTS'],
        gradeLevels: ['L·ªõp 6', 'L·ªõp 7', 'L·ªõp 8', 'L·ªõp 9', 'L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi IELTS', 'Ng∆∞·ªùi ƒëi l√†m'],
        experience: 5,
        hourlyRate: 220000,
        occupation: 'Chuy√™n gia',
        rating: 48,
        totalReviews: 67,
        totalStudents: 48,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['IELTS 8.0', 'TESOL Certificate']),
        achievements: JSON.stringify(['85% h·ªçc sinh ƒë·∫°t band 6.5+']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '18:00', end: '21:00' }, // T2 t·ªëi
          { day: 2, shift: 'evening', start: '18:00', end: '21:00' }, // T3 t·ªëi
          { day: 3, shift: 'evening', start: '18:00', end: '21:00' }, // T4 t·ªëi
          { day: 4, shift: 'evening', start: '18:00', end: '21:00' }, // T5 t·ªëi
          { day: 5, shift: 'evening', start: '18:00', end: '21:00' }, // T6 t·ªëi
          { day: 6, shift: 'afternoon', start: '14:00', end: '20:00' }, // T7 chi·ªÅu-t·ªëi
        ]
      },
      {
        username: 'tutor_nam',
        email: 'nam@example.com',
        fullName: 'V≈© Ho√†ng Nam',
        avatar: 'https://i.pravatar.cc/150?img=68',
        bio: 'K·ªπ s∆∞ ph·∫ßn m·ªÅm ki√™m gi√°o vi√™n To√°n v√† Tin h·ªçc. V·ªõi kinh nghi·ªám l√†m vi·ªác t·∫°i c√°c c√¥ng ty c√¥ng ngh·ªá l·ªõn, t√¥i mang ki·∫øn th·ª©c th·ª±c t·∫ø v√†o gi·∫£ng d·∫°y, gi√∫p h·ªçc sinh hi·ªÉu ƒë∆∞·ª£c ·ª©ng d·ª•ng th·ª±c ti·ªÖn c·ªßa m√¥n h·ªçc.',
        teachingMethod: 'K·∫øt h·ª£p l√Ω thuy·∫øt v·ªõi coding th·ª±c h√†nh. S·ª≠ d·ª•ng c√°c d·ª± √°n mini ƒë·ªÉ h·ªçc sinh √°p d·ª•ng ki·∫øn th·ª©c ngay l·∫≠p t·ª©c. H·ªçc To√°n qua l·∫≠p tr√¨nh v√† gi·∫£i thu·∫≠t.',
        education: JSON.stringify([{
          degree: 'Th·∫°c sƒ© Khoa h·ªçc M√°y t√≠nh',
          school: 'ƒê·∫°i h·ªçc B√°ch khoa H√† N·ªôi',
          year: '2020'
        }]),
        subjects: ['To√°n', 'Tin h·ªçc'],
        gradeLevels: ['L·ªõp 6', 'L·ªõp 7', 'L·ªõp 8', 'L·ªõp 9', 'L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'ƒê·∫°i h·ªçc'],
        experience: 3,
        hourlyRate: 200000,
        occupation: 'Chuy√™n gia',
        rating: 47,
        totalReviews: 38,
        totalStudents: 24,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['AWS Certified', 'Google Cloud Professional']),
        achievements: JSON.stringify(['K·ªπ s∆∞ t·∫°i FPT Software']),
        timeSlots: [
          { day: 6, shift: 'morning', start: '08:00', end: '12:00' }, // T7 s√°ng
          { day: 6, shift: 'afternoon', start: '14:00', end: '18:00' }, // T7 chi·ªÅu
          { day: 0, shift: 'morning', start: '08:00', end: '12:00' }, // CN s√°ng
          { day: 0, shift: 'afternoon', start: '14:00', end: '18:00' }, // CN chi·ªÅu
        ]
      },
      {
        username: 'tutor_anh',
        email: 'anh.nguyen@example.com',
        fullName: 'Nguy·ªÖn Minh Anh',
        avatar: 'https://i.pravatar.cc/150?img=38',
        bio: 'Sinh vi√™n Y khoa gi·ªèi, chuy√™n d·∫°y H√≥a h·ªçc v√† Sinh h·ªçc cho h·ªçc sinh THPT. V·ªõi ki·∫øn th·ª©c y khoa, t√¥i gi√∫p h·ªçc sinh hi·ªÉu s√¢u v·ªÅ c∆° th·ªÉ ng∆∞·ªùi v√† c√°c ph·∫£n ·ª©ng h√≥a h·ªçc trong y h·ªçc.',
        teachingMethod: 'Gi·∫£ng d·∫°y l√Ω thuy·∫øt k·∫øt h·ª£p v·ªõi c√°c v√≠ d·ª• y h·ªçc th·ª±c t·∫ø. H·ªá th·ªëng h√≥a ki·∫øn th·ª©c v√† t·∫≠p trung v√†o c√°c d·∫°ng b√†i thi th∆∞·ªùng g·∫∑p. C√≥ ng√¢n h√†ng c√¢u h·ªèi l·ªõn ƒë·ªÉ luy·ªán t·∫≠p.',
        education: JSON.stringify([{
          degree: 'Sinh vi√™n nƒÉm 5 Y khoa',
          school: 'ƒê·∫°i h·ªçc Y H√† N·ªôi',
          year: '2025'
        }]),
        subjects: ['H√≥a h·ªçc', 'Sinh h·ªçc'],
        gradeLevels: ['L·ªõp 10', 'L·ªõp 11', 'L·ªõp 12', 'Luy·ªán thi ƒê·∫°i h·ªçc'],
        experience: 2,
        hourlyRate: 140000,
        occupation: 'Sinh vi√™n',
        rating: 46,
        totalReviews: 29,
        totalStudents: 18,
        verificationStatus: 'verified',
        certifications: JSON.stringify(['H·ªçc b·ªïng to√†n ph·∫ßn ƒê·∫°i h·ªçc Y']),
        achievements: JSON.stringify(['GPA 3.9/4.0', 'Gi·∫£i Nh√¨ Olympic Sinh h·ªçc SV 2023']),
        timeSlots: [
          { day: 1, shift: 'evening', start: '18:00', end: '21:00' }, // T2 t·ªëi
          { day: 3, shift: 'evening', start: '18:00', end: '21:00' }, // T4 t·ªëi
          { day: 5, shift: 'evening', start: '18:00', end: '21:00' }, // T6 t·ªëi
          { day: 6, shift: 'morning', start: '08:00', end: '12:00' }, // T7 s√°ng
          { day: 0, shift: 'afternoon', start: '14:00', end: '18:00' }, // CN chi·ªÅu
        ]
      },
    ];

    for (const tutorData of tutorsData) {
      console.log(`\n  Creating ${tutorData.fullName}...`);

      // Create user account
      const hashedPassword = await bcrypt.hash('password123', 10);
      const userResult = await db.insert(users).values({
        username: tutorData.username,
        email: tutorData.email,
        password: hashedPassword,
        role: 'tutor'
      });
      const userId = Number(userResult[0].insertId);
      console.log(`    ‚úì User account created`);

      // Create tutor profile
      const tutorResult = await db.insert(tutors).values({
        userId: userId,
        fullName: tutorData.fullName,
        avatar: tutorData.avatar,
        bio: tutorData.bio,
        teachingMethod: tutorData.teachingMethod,
        education: tutorData.education,
        subjects: JSON.stringify([]), // Empty - will use tutor_subjects table
        experience: tutorData.experience,
        hourlyRate: tutorData.hourlyRate,
        occupation: tutorData.occupation,
        rating: tutorData.rating,
        totalReviews: tutorData.totalReviews,
        totalStudents: tutorData.totalStudents,
        verificationStatus: tutorData.verificationStatus as 'verified',
        certifications: tutorData.certifications,
        achievements: tutorData.achievements
      });
      const tutorId = Number(tutorResult[0].insertId);
      console.log(`    ‚úì Tutor profile created`);

      // Create tutor-subject relationships
      for (const subjectName of tutorData.subjects) {
        const subject = insertedSubjects.find(s => s.name === subjectName);
        if (!subject) continue;

        for (const gradeLevelName of tutorData.gradeLevels) {
          const gradeLevel = insertedGradeLevels.find(g => g.name === gradeLevelName);
          if (!gradeLevel) continue;

          await db.insert(tutorSubjects).values({
            tutorId: tutorId,
            subjectId: subject.id,
            gradeLevelId: gradeLevel.id
          });
        }
      }
      console.log(`    ‚úì ${tutorData.subjects.length} subjects √ó ${tutorData.gradeLevels.length} grade levels = ${tutorData.subjects.length * tutorData.gradeLevels.length} relationships`);

      // Create time slots
      for (const slot of tutorData.timeSlots) {
        await db.insert(timeSlots).values({
          tutorId: tutorId,
          dayOfWeek: slot.day,
          shiftType: slot.shift as 'morning' | 'afternoon' | 'evening',
          startTime: slot.start,
          endTime: slot.end,
          isAvailable: 1
        });
      }
      console.log(`    ‚úì ${tutorData.timeSlots.length} time slots created`);
    }

    console.log('\n‚úÖ Successfully seeded optimized database!');
    console.log('\nüìä Summary:');
    console.log(`  - ${insertedSubjects.length} subjects`);
    console.log(`  - ${insertedGradeLevels.length} grade levels`);
    console.log(`  - ${tutorsData.length} tutors`);
    console.log(`  - Tutor-subject relationships with normalized data`);
    console.log(`  - Time slots with shift types and calculated fees`);

    console.log('\nüîë Login credentials:');
    console.log('  Password: password123');
    console.log('\n  Usernames:');
    tutorsData.forEach(t => console.log(`    - ${t.username}`));

  } catch (error) {
    console.error('\n‚ùå Error seeding database:', error);
    throw error;
  }
}

seedOptimizedDatabase()
  .then(() => {
    console.log('\n‚ú® Seeding completed!');
    process.exit(0);
  })
  .catch((error) => {
    console.error('Failed:', error);
    process.exit(1);
  });
